{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\denis\\\\OneDrive\\\\\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B\\\\\\u041A\\u0443\\u0440\\u0441\\u043E\\u0432\\u0430\\u044F\\\\my-app\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useState, useContext, useEffect, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [user, setUser] = useState(null);\n  const [orders, setOrders] = useState([]);\n  const [tariffs, setTariffs] = useState([]);\n  const [accessToken, setAccessToken] = useState(() => localStorage.getItem('accessToken'));\n  const [refreshToken, setRefreshToken] = useState(() => localStorage.getItem('refreshToken'));\n  const navigate = useNavigate();\n  const isMounted = useRef(true);\n  useEffect(() => {\n    if (accessToken) {\n      fetchUser(accessToken);\n    }\n    return () => {\n      isMounted.current = false;\n    };\n  }, [accessToken]);\n  const login = async credentials => {\n    try {\n      const response = await fetch('/auth/token/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(credentials)\n      });\n      if (!response.ok) {\n        throw new Error('Ошибка авторизации');\n      }\n      const data = await response.json();\n      setAccessToken(data.access);\n      setRefreshToken(data.refresh);\n      localStorage.setItem('accessToken', data.access);\n      localStorage.setItem('refreshToken', data.refresh);\n      const userData = await fetchUser(data.access);\n      // Навигация в зависимости от роли пользователя\n      if (userData && userData.is_staff) {\n        navigate('/admin-tariffs');\n      } else if (userData && userData.is_worker) {\n        navigate('/worker');\n      } else {\n        navigate('/dashboard');\n      }\n    } catch (error) {\n      console.error('Login error:', error);\n    }\n  };\n  const register = async registrationData => {\n    try {\n      const response = await fetch('/auth/register/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(registrationData)\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.detail || 'Ошибка регистрации');\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Registration error:', error);\n      throw error;\n    }\n  };\n  const refreshAccessToken = useCallback(async () => {\n    if (!refreshToken) {\n      return null;\n    }\n    try {\n      const response = await fetch('/auth/token/refresh/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          refresh: refreshToken\n        })\n      });\n      if (!response.ok) {\n        throw new Error('Ошибка обновления токена');\n      }\n      const data = await response.json();\n      setAccessToken(data.access);\n      return data.access;\n    } catch (error) {\n      console.error('Error refreshing access token:', error);\n      logout();\n      return null;\n    }\n  }, [refreshToken]);\n  const authFetch = useCallback(async (url, options = {}, retry = true) => {\n    if (!options.headers) {\n      options.headers = {};\n    }\n    if (accessToken) {\n      options.headers['Authorization'] = `Bearer ${accessToken}`;\n    }\n    let response = await fetch(url, options);\n    if (response.status === 401 && retry) {\n      const newAccessToken = await refreshAccessToken();\n      if (newAccessToken) {\n        options.headers['Authorization'] = `Bearer ${newAccessToken}`;\n        response = await fetch(url, options);\n      }\n    }\n    return response;\n  }, [accessToken, refreshAccessToken]);\n  const fetchUser = async token => {\n    try {\n      console.log('Access token in fetchUser:', token);\n      const response = await authFetch('/users/me/', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.status === 401) {\n        console.error('Unauthorized in fetchUser, redirecting to login');\n        setUser(null);\n        setAccessToken(null);\n        setRefreshToken(null);\n        if (isMounted.current) {\n          navigate('/login');\n        }\n        return null;\n      }\n      const data = await response.json();\n      if (data) {\n        setUser(data);\n        console.log('User is_worker:', data.is_worker);\n        await fetchOrders(data.id, token);\n        await fetchTariffs(token);\n        return data;\n      } else {\n        setUser(null);\n        setOrders([]);\n        return null;\n      }\n    } catch (error) {\n      console.error('Error fetching user:', error);\n      return null;\n    }\n  };\n  const fetchTariffs = async () => {\n    try {\n      const response = await authFetch('/tariffs/');\n      if (!response.ok) {\n        throw new Error('Ошибка загрузки тарифов');\n      }\n      const data = await response.json();\n      setTariffs(data);\n    } catch (error) {\n      console.error('Error fetching tariffs:', error);\n      setTariffs([]);\n    }\n  };\n  const updateUser = async updatedData => {\n    if (!accessToken || !user) {\n      console.error('No access token or user to update');\n      return;\n    }\n    try {\n      console.log('Updating user with data:', updatedData);\n      const response = await authFetch(`/users/${user.id}/`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(updatedData)\n      });\n      console.log('Update user response status:', response.status);\n      if (response.status === 401) {\n        console.error('Unauthorized in updateUser, redirecting to login');\n        setUser(null);\n        setAccessToken(null);\n        setRefreshToken(null);\n        if (isMounted.current) {\n          navigate('/login');\n        }\n        return;\n      }\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('Error response text:', errorText);\n        throw new Error('Ошибка обновления пользователя');\n      }\n      const data = await response.json();\n      console.log('Updated user data:', data);\n      setUser(data);\n    } catch (error) {\n      console.error('Error updating user:', error);\n    }\n  };\n  const fetchOrders = async userId => {\n    try {\n      console.log('Fetching orders for userId:', userId);\n      const response = await authFetch(`/orders/?user=${userId}`);\n      const data = await response.json();\n      console.log('Orders fetched:', data);\n      setOrders(Array.isArray(data) ? data : []);\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n      setOrders([]);\n    }\n  };\n  const fetchAllOrders = useCallback(async () => {\n    try {\n      const response = await authFetch(`/orders/`);\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('Error response text:', errorText);\n        setOrders([]);\n        return;\n      }\n      const data = await response.json();\n      console.log('All orders fetched:', data);\n      setOrders(Array.isArray(data) ? data : []);\n    } catch (error) {\n      console.error('Error fetching all orders:', error);\n      setOrders([]);\n    }\n  }, [authFetch]);\n  const createOrder = async tariffId => {\n    try {\n      const body = {\n        tariff_id: tariffId\n      };\n      console.log('Request body in createOrder:', body);\n      const response = await authFetch('/orders/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n      const newOrder = await response.json();\n      console.log('Response from createOrder:', newOrder);\n      if (!response.ok) {\n        throw new Error(JSON.stringify(newOrder));\n      }\n      setOrders([...orders, newOrder]);\n      return newOrder;\n    } catch (error) {\n      console.error('Error creating order:', error);\n    }\n  };\n  const logout = () => {\n    setUser(null);\n    setAccessToken(null);\n    setRefreshToken(null);\n    localStorage.removeItem('accessToken');\n    localStorage.removeItem('refreshToken');\n    if (isMounted.current) {\n      navigate('/login');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      orders,\n      setOrders,\n      tariffs,\n      setTariffs,\n      login,\n      register,\n      createOrder,\n      updateUser,\n      fetchUser,\n      fetchAllOrders,\n      fetchTariffs,\n      accessToken,\n      logout,\n      authFetch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 266,\n    columnNumber: 3\n  }, this);\n}\n_s(AuthProvider, \"2RcXu8lo01EK7ia1TOvFiCqDFOI=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  return useContext(AuthContext);\n}\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useContext","useEffect","useRef","useCallback","useNavigate","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","orders","setOrders","tariffs","setTariffs","accessToken","setAccessToken","localStorage","getItem","refreshToken","setRefreshToken","navigate","isMounted","fetchUser","current","login","credentials","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","access","refresh","setItem","userData","is_staff","is_worker","error","console","register","registrationData","errorData","detail","refreshAccessToken","logout","authFetch","url","options","retry","status","newAccessToken","token","log","Authorization","fetchOrders","id","fetchTariffs","updateUser","updatedData","errorText","text","userId","Array","isArray","fetchAllOrders","createOrder","tariffId","tariff_id","newOrder","removeItem","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["C:/Users/denis/OneDrive/Документы/Курсовая/my-app/src/contexts/AuthContext.js"],"sourcesContent":["import { createContext, useState, useContext, useEffect, useRef, useCallback } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\n\r\nconst AuthContext = createContext()\r\n\r\nexport function AuthProvider({ children }) {\r\n\tconst [user, setUser] = useState(null)\r\n\tconst [orders, setOrders] = useState([])\r\n\tconst [tariffs, setTariffs] = useState([])\r\n\tconst [accessToken, setAccessToken] = useState(() => localStorage.getItem('accessToken'))\r\n\tconst [refreshToken, setRefreshToken] = useState(() => localStorage.getItem('refreshToken'))\r\n\tconst navigate = useNavigate()\r\n\tconst isMounted = useRef(true)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (accessToken) {\r\n\t\t\tfetchUser(accessToken)\r\n\t\t}\r\n\t\treturn () => {\r\n\t\t\tisMounted.current = false\r\n\t\t}\r\n\t}, [accessToken])\r\n\r\n\tconst login = async credentials => {\r\n\t\ttry {\r\n\t\t\tconst response = await fetch('/auth/token/', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t\tbody: JSON.stringify(credentials),\r\n\t\t\t})\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthrow new Error('Ошибка авторизации')\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tsetAccessToken(data.access)\r\n\t\t\tsetRefreshToken(data.refresh)\r\n\t\t\tlocalStorage.setItem('accessToken', data.access)\r\n\t\t\tlocalStorage.setItem('refreshToken', data.refresh)\r\n\t\t\tconst userData = await fetchUser(data.access)\r\n\t\t\t// Навигация в зависимости от роли пользователя\r\n\t\t\tif (userData && userData.is_staff) {\r\n\t\t\t\tnavigate('/admin-tariffs')\r\n\t\t\t} else if (userData && userData.is_worker) {\r\n\t\t\t\tnavigate('/worker')\r\n\t\t\t} else {\r\n\t\t\t\tnavigate('/dashboard')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Login error:', error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst register = async (registrationData) => {\r\n\t\ttry {\r\n\t\t\tconst response = await fetch('/auth/register/', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t\tbody: JSON.stringify(registrationData),\r\n\t\t\t})\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tconst errorData = await response.json()\r\n\t\t\t\tthrow new Error(errorData.detail || 'Ошибка регистрации')\r\n\t\t\t}\r\n\t\t\treturn await response.json()\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Registration error:', error)\r\n\t\t\tthrow error\r\n\t\t}\r\n\t}\r\n\r\n\tconst refreshAccessToken = useCallback(async () => {\r\n\t\tif (!refreshToken) {\r\n\t\t\treturn null\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconst response = await fetch('/auth/token/refresh/', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t\tbody: JSON.stringify({ refresh: refreshToken }),\r\n\t\t\t})\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthrow new Error('Ошибка обновления токена')\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tsetAccessToken(data.access)\r\n\t\t\treturn data.access\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error refreshing access token:', error)\r\n\t\t\tlogout()\r\n\t\t\treturn null\r\n\t\t}\r\n\t}, [refreshToken])\r\n\r\n\tconst authFetch = useCallback(async (url, options = {}, retry = true) => {\r\n\t\tif (!options.headers) {\r\n\t\t\toptions.headers = {}\r\n\t\t}\r\n\t\tif (accessToken) {\r\n\t\t\toptions.headers['Authorization'] = `Bearer ${accessToken}`\r\n\t\t}\r\n\t\tlet response = await fetch(url, options)\r\n\t\tif (response.status === 401 && retry) {\r\n\t\t\tconst newAccessToken = await refreshAccessToken()\r\n\t\t\tif (newAccessToken) {\r\n\t\t\t\toptions.headers['Authorization'] = `Bearer ${newAccessToken}`\r\n\t\t\t\tresponse = await fetch(url, options)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn response\r\n\t}, [accessToken, refreshAccessToken])\r\n\r\n\tconst fetchUser = async (token) => {\r\n\t\ttry {\r\n\t\t\tconsole.log('Access token in fetchUser:', token)\r\n\t\t\tconst response = await authFetch('/users/me/', {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\tif (response.status === 401) {\r\n\t\t\t\tconsole.error('Unauthorized in fetchUser, redirecting to login')\r\n\t\t\t\tsetUser(null)\r\n\t\t\t\tsetAccessToken(null)\r\n\t\t\t\tsetRefreshToken(null)\r\n\t\t\t\tif (isMounted.current) {\r\n\t\t\t\t\tnavigate('/login')\r\n\t\t\t\t}\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tif (data) {\r\n\t\t\t\tsetUser(data)\r\n\t\t\t\tconsole.log('User is_worker:', data.is_worker)\r\n\t\t\t\tawait fetchOrders(data.id, token)\r\n\t\t\t\tawait fetchTariffs(token)\r\n\t\t\t\treturn data\r\n\t\t\t} else {\r\n\t\t\t\tsetUser(null)\r\n\t\t\t\tsetOrders([])\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error fetching user:', error)\r\n\t\t\treturn null\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchTariffs = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await authFetch('/tariffs/')\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthrow new Error('Ошибка загрузки тарифов')\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tsetTariffs(data)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error fetching tariffs:', error)\r\n\t\t\tsetTariffs([])\r\n\t\t}\r\n\t}\r\n\r\n\tconst updateUser = async (updatedData) => {\r\n\t\tif (!accessToken || !user) {\r\n\t\t\tconsole.error('No access token or user to update')\r\n\t\t\treturn\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tconsole.log('Updating user with data:', updatedData)\r\n\t\t\tconst response = await authFetch(`/users/${user.id}/`, {\r\n\t\t\t\tmethod: 'PATCH',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t\tbody: JSON.stringify(updatedData),\r\n\t\t\t})\r\n\t\t\tconsole.log('Update user response status:', response.status)\r\n\t\t\tif (response.status === 401) {\r\n\t\t\t\tconsole.error('Unauthorized in updateUser, redirecting to login')\r\n\t\t\t\tsetUser(null)\r\n\t\t\t\tsetAccessToken(null)\r\n\t\t\t\tsetRefreshToken(null)\r\n\t\t\t\tif (isMounted.current) {\r\n\t\t\t\t\tnavigate('/login')\r\n\t\t\t\t}\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tconst errorText = await response.text()\r\n\t\t\t\tconsole.error('Error response text:', errorText)\r\n\t\t\t\tthrow new Error('Ошибка обновления пользователя')\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tconsole.log('Updated user data:', data)\r\n\t\t\tsetUser(data)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error updating user:', error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchOrders = async (userId) => {\r\n\t\ttry {\r\n\t\t\tconsole.log('Fetching orders for userId:', userId)\r\n\t\t\tconst response = await authFetch(`/orders/?user=${userId}`)\r\n\t\t\tconst data = await response.json()\r\n\t\t\tconsole.log('Orders fetched:', data)\r\n\t\t\tsetOrders(Array.isArray(data) ? data : [])\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error fetching orders:', error)\r\n\t\t\tsetOrders([])\r\n\t\t}\r\n\t}\r\n\r\n\tconst fetchAllOrders = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await authFetch(`/orders/`)\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tconst errorText = await response.text()\r\n\t\t\t\tconsole.error('Error response text:', errorText)\r\n\t\t\t\tsetOrders([])\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tconst data = await response.json()\r\n\t\t\tconsole.log('All orders fetched:', data)\r\n\t\t\tsetOrders(Array.isArray(data) ? data : [])\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error fetching all orders:', error)\r\n\t\t\tsetOrders([])\r\n\t\t}\r\n\t}, [authFetch])\r\n\r\n\tconst createOrder = async tariffId => {\r\n\t\ttry {\r\n\t\t\tconst body = { tariff_id: tariffId }\r\n\t\t\tconsole.log('Request body in createOrder:', body)\r\n\t\t\tconst response = await authFetch('/orders/', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t\tbody: JSON.stringify(body),\r\n\t\t\t})\r\n\t\t\tconst newOrder = await response.json()\r\n\t\t\tconsole.log('Response from createOrder:', newOrder)\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthrow new Error(JSON.stringify(newOrder))\r\n\t\t\t}\r\n\t\t\tsetOrders([...orders, newOrder])\r\n\t\t\treturn newOrder\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error creating order:', error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst logout = () => {\r\n\t\tsetUser(null)\r\n\t\tsetAccessToken(null)\r\n\t\tsetRefreshToken(null)\r\n\t\tlocalStorage.removeItem('accessToken')\r\n\t\tlocalStorage.removeItem('refreshToken')\r\n\t\tif (isMounted.current) {\r\n\t\t\tnavigate('/login')\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<AuthContext.Provider value={{ user, orders, setOrders, tariffs, setTariffs, login, register, createOrder, updateUser, fetchUser, fetchAllOrders, fetchTariffs, accessToken, logout, authFetch }}>\r\n\t\t\t{children}\r\n\t\t</AuthContext.Provider>\r\n\t)\r\n}\r\n\r\nexport function useAuth() {\r\n\treturn useContext(AuthContext)\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}